<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{members.list.title}">Members List</title>
    <link rel="stylesheet" th:href="@{/css/sidebar.css}" />
    <link rel="stylesheet" th:href="@{/css/membersList.css}" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script th:src="@{/js/sidebar.js}" defer></script>
</head>
<body>

<!-- Sidebar -->
<div th:replace="~{fragments :: sidebar}"></div>

<!-- Main content -->
<main class="members-container">
    <!-- Header section -->
    <div class="members-header">
        <h1 class="title" th:text="#{members.list.heading}">Members</h1>
        <div class="header-actions">
            <form id="filterForm" method="get" action="/members" class="filters-container">
                <div class="status-filter">
                    <select name="status" id="statusFilter">
                        <option value="" th:text="#{filter.status.all}">All Status</option>
                        <option value="ACTIVE" th:selected="${status == 'ACTIVE'}"
                                th:text="#{${'member.status.' + 'ACTIVE'}}">Active</option>
                        <option value="INACTIVE" th:selected="${status == 'INACTIVE'}"
                                th:text="#{${'member.status.' + 'INACTIVE'}}">Inactive</option>
                    </select>
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" name="search" id="searchInput"
                           th:placeholder="#{members.search.placeholder}"
                           th:value="${search}">
                </div>
            </form>

            <button class="add-member-btn" onclick="window.location.href='/members/add'">
                <i class="fas fa-plus"></i>
                <span th:text="#{members.add.button}">Add Member</span>
            </button>
        </div>
    </div>

    <!-- Members table -->
    <div class="members-table-wrapper">
        <table class="members-table">
            <thead>
            <tr>
                <th th:text="#{member.firstName}">First Name</th>
                <th th:text="#{member.lastName}">Last Name</th>
                <th th:text="#{member.email}">Email</th>
                <th th:text="#{member.status}">Status</th>
                <th th:text="#{table.actions}">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="member : ${members}">
                <td th:text="${member.firstName}">John</td>
                <td th:text="${member.lastName}">Doe</td>
                <td th:text="${member.email}">john@example.com</td>
                <td>
                    <span th:classappend="${member.memberStatus.name() == 'ACTIVE'} ? 'status-pill active' : 'status-pill inactive'"
                          th:text="#{${'member.status.' + member.memberStatus.name()}}">
                        Active
                    </span>
                </td>
                <td class="actions">
                    <a th:href="@{/members/view/{id}(id=${member.id})}" th:title="#{table.view}">
                        <i class="fa-solid fa-eye"></i>
                    </a>
                    <a th:href="@{/members/edit/{id}(id=${member.id})}" th:title="#{table.edit}">
                        <i class="fa-solid fa-pencil"></i>
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Enhanced Pagination -->
    <div class="pagination">
        <a th:if="${currentPage > 0}"
           th:href="@{/members(page=${currentPage - 1}, size=10, search=${search}, status=${status})}">
            <i class="fas fa-chevron-left"></i> <span th:text="#{pagination.previous}">Previous</span>
        </a>

        <span th:text="#{pagination.page(${currentPage + 1},${totalPages})}">
            Page 1 of 1
        </span>

        <a th:if="${currentPage + 1 < totalPages}"
           th:href="@{/members(page=${currentPage + 1}, size=10, search=${search}, status=${status})}">
            <span th:text="#{pagination.next}">Next</span> <i class="fas fa-chevron-right"></i>
        </a>
    </div>
</main>
</body>
</html>
